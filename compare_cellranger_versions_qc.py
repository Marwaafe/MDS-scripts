
[mafechkar@ares MDS_Data]$ python compare_cellranger_versions_qc.py
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS001-09-203_count_output/MDS001-09-203_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS001-09-203_count_output/MDS001-09-203_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS001-09-203_count_output/MDS001-09-203_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS001-09-203_count_output/MDS001-09-203_count/outs/metrics_summary.csv
❌ Missing file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS001-09-203_count_output/MDS001-09-203_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS005-09-247_count_output/MDS005-09-247_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS005-09-247_count_output/MDS005-09-247_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS005-09-247_count_output/MDS005-09-247_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS005-09-247_count_output/MDS005-09-247_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS005-09-247_count_output/MDS005-09-247_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS005-09-247_count_output/MDS005-09-247_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS005-09-247_count_output/MDS005-09-247_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS005-09-247_count_output/MDS005-09-247_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS006-08-249_count_output/MDS006-08-249_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS006-08-249_count_output/MDS006-08-249_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS006-08-249_count_output/MDS006-08-249_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS006-08-249_count_output/MDS006-08-249_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS006-08-249_count_output/MDS006-08-249_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS006-08-249_count_output/MDS006-08-249_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS006-08-249_count_output/MDS006-08-249_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS006-08-249_count_output/MDS006-08-249_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS010-09-299_count_output/MDS010-09-299_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS010-09-299_count_output/MDS010-09-299_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS010-09-299_count_output/MDS010-09-299_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS010-09-299_count_output/MDS010-09-299_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS010-09-299_count_output/MDS010-09-299_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS010-09-299_count_output/MDS010-09-299_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS010-09-299_count_output/MDS010-09-299_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS010-09-299_count_output/MDS010-09-299_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS016-09-478_count_output/MDS016-09-478_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS016-09-478_count_output/MDS016-09-478_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS016-09-478_count_output/MDS016-09-478_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS016-09-478_count_output/MDS016-09-478_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS016-09-478_count_output/MDS016-09-478_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS016-09-478_count_output/MDS016-09-478_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS016-09-478_count_output/MDS016-09-478_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS016-09-478_count_output/MDS016-09-478_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS023-10-053_count_output/MDS023-10-053_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS023-10-053_count_output/MDS023-10-053_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS023-10-053_count_output/MDS023-10-053_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS023-10-053_count_output/MDS023-10-053_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS023-10-053_count_output/MDS023-10-053_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS023-10-053_count_output/MDS023-10-053_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS023-10-053_count_output/MDS023-10-053_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS023-10-053_count_output/MDS023-10-053_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS029-10-118_count_output/MDS029-10-118_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS029-10-118_count_output/MDS029-10-118_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS029-10-118_count_output/MDS029-10-118_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS029-10-118_count_output/MDS029-10-118_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS029-10-118_count_output/MDS029-10-118_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS029-10-118_count_output/MDS029-10-118_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS029-10-118_count_output/MDS029-10-118_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS029-10-118_count_output/MDS029-10-118_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS038-10-241_count_output/MDS038-10-241_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS038-10-241_count_output/MDS038-10-241_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS038-10-241_count_output/MDS038-10-241_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS038-10-241_count_output/MDS038-10-241_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS038-10-241_count_output/MDS038-10-241_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS038-10-241_count_output/MDS038-10-241_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS038-10-241_count_output/MDS038-10-241_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS038-10-241_count_output/MDS038-10-241_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS059-10-531_count_output/MDS059-10-531_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS059-10-531_count_output/MDS059-10-531_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS059-10-531_count_output/MDS059-10-531_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS059-10-531_count_output/MDS059-10-531_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS059-10-531_count_output/MDS059-10-531_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS059-10-531_count_output/MDS059-10-531_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS059-10-531_count_output/MDS059-10-531_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS059-10-531_count_output/MDS059-10-531_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS065-10-609_count_output/MDS065-10-609_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS065-10-609_count_output/MDS065-10-609_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS065-10-609_count_output/MDS065-10-609_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS065-10-609_count_output/MDS065-10-609_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS065-10-609_count_output/MDS065-10-609_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS065-10-609_count_output/MDS065-10-609_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS065-10-609_count_output/MDS065-10-609_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS065-10-609_count_output/MDS065-10-609_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS154-13-486_count_output/MDS154-13-486_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS154-13-486_count_output/MDS154-13-486_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS154-13-486_count_output/MDS154-13-486_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS154-13-486_count_output/MDS154-13-486_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS154-13-486_count_output/MDS154-13-486_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS154-13-486_count_output/MDS154-13-486_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS154-13-486_count_output/MDS154-13-486_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS154-13-486_count_output/MDS154-13-486_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS155-13-606_count_output/MDS155-13-606_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS155-13-606_count_output/MDS155-13-606_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS155-13-606_count_output/MDS155-13-606_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS155-13-606_count_output/MDS155-13-606_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS155-13-606_count_output/MDS155-13-606_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS155-13-606_count_output/MDS155-13-606_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS155-13-606_count_output/MDS155-13-606_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS155-13-606_count_output/MDS155-13-606_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS167-13-913_count_output/MDS167-13-913_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS167-13-913_count_output/MDS167-13-913_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS167-13-913_count_output/MDS167-13-913_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS167-13-913_count_output/MDS167-13-913_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS167-13-913_count_output/MDS167-13-913_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS167-13-913_count_output/MDS167-13-913_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS167-13-913_count_output/MDS167-13-913_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS167-13-913_count_output/MDS167-13-913_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS169-13-919_count_output/MDS169-13-919_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS169-13-919_count_output/MDS169-13-919_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS169-13-919_count_output/MDS169-13-919_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS169-13-919_count_output/MDS169-13-919_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS169-13-919_count_output/MDS169-13-919_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS169-13-919_count_output/MDS169-13-919_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS169-13-919_count_output/MDS169-13-919_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS169-13-919_count_output/MDS169-13-919_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS180-14-164_count_output/MDS180-14-164_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS180-14-164_count_output/MDS180-14-164_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS180-14-164_count_output/MDS180-14-164_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS180-14-164_count_output/MDS180-14-164_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS180-14-164_count_output/MDS180-14-164_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS180-14-164_count_output/MDS180-14-164_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS180-14-164_count_output/MDS180-14-164_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS180-14-164_count_output/MDS180-14-164_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS189-14-527_count_output/MDS189-14-527_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS189-14-527_count_output/MDS189-14-527_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS189-14-527_count_output/MDS189-14-527_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS189-14-527_count_output/MDS189-14-527_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS189-14-527_count_output/MDS189-14-527_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS189-14-527_count_output/MDS189-14-527_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS189-14-527_count_output/MDS189-14-527_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS189-14-527_count_output/MDS189-14-527_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS201-15-093_count_output/MDS201-15-093_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS201-15-093_count_output/MDS201-15-093_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS201-15-093_count_output/MDS201-15-093_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS201-15-093_count_output/MDS201-15-093_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS201-15-093_count_output/MDS201-15-093_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS201-15-093_count_output/MDS201-15-093_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS201-15-093_count_output/MDS201-15-093_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS201-15-093_count_output/MDS201-15-093_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS212-15-463_count_output/MDS212-15-463_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS212-15-463_count_output/MDS212-15-463_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS212-15-463_count_output/MDS212-15-463_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount/MDS212-15-463_count_output/MDS212-15-463_count/outs/metrics_summary.csv
⚠️  Missing metric 'Mean Reads per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS212-15-463_count_output/MDS212-15-463_count/outs/metrics_summary.csv
⚠️  Missing metric 'Median Genes per Cell' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS212-15-463_count_output/MDS212-15-463_count/outs/metrics_summary.csv
⚠️  Missing metric 'Fraction Reads in Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS212-15-463_count_output/MDS212-15-463_count/outs/metrics_summary.csv
⚠️  Missing fallback metrics ['Estimated Number of Cells', 'Total Genes Detected'] for 'Estimated_Cells' in file: /trinity/home/mafechkar/MDS_OUTS_CellRangerCount_9.0/MDS212-15-463_count_output/MDS212-15-463_count/outs/metrics_summary.csv
Traceback (most recent call last):
  File "/net/beegfs/scratch/mafechkar/MDS_Data/compare_cellranger_versions_qc.py", line 85, in <module>
    g = sns.catplot(
        ^^^^^^^^^^^^
  File "/trinity/home/mafechkar/miniconda3/lib/python3.12/site-packages/seaborn/categorical.py", line 2782, in catplot
    p = Plotter(
        ^^^^^^^^
  File "/trinity/home/mafechkar/miniconda3/lib/python3.12/site-packages/seaborn/categorical.py", line 67, in __init__
    super().__init__(data=data, variables=variables)
  File "/trinity/home/mafechkar/miniconda3/lib/python3.12/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/trinity/home/mafechkar/miniconda3/lib/python3.12/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/trinity/home/mafechkar/miniconda3/lib/python3.12/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/trinity/home/mafechkar/miniconda3/lib/python3.12/site-packages/seaborn/_core/data.py", line 232, in _assign_variables
    raise ValueError(err)
ValueError: Could not interpret value `Version` for `hue`. An entry with this name does not appear in `data`.


import os
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# Real sample names
samples = [
    "MDS001-09-203", "MDS005-09-247", "MDS006-08-249", "MDS010-09-299",
    "MDS016-09-478", "MDS023-10-053", "MDS029-10-118", "MDS038-10-241",
    "MDS059-10-531", "MDS065-10-609", "MDS154-13-486", "MDS155-13-606",
    "MDS167-13-913", "MDS169-13-919", "MDS180-14-164", "MDS189-14-527",
    "MDS201-15-093", "MDS212-15-463"
]

# Output directories for different Cell Ranger versions
versions = {
    "7.2.0": "MDS_Data/MDS_OUTS_CellRangerCount",
    "9.0.0": "MDS_Data/MDS_OUTS_CellRangerCount_9.0.0"
}

# Standard metrics to extract (exact match)
metrics_to_extract = {
    "Mean Reads per Cell": "Mean_Reads_Per_Cell",
    "Median Genes per Cell": "Median_Genes_Per_Cell",
    "Fraction Reads in Cells": "Fraction_Reads_In_Cells"
}

# Metrics with fallback names
fallback_metrics = {
    "Estimated_Cells": ["Estimated Number of Cells", "Total Genes Detected"]
}

# Gather data
data = []

for sample in samples:
    for version, base_dir in versions.items():
        csv_path = os.path.join(
            base_dir,
            f"{sample}_count_output",
            f"{sample}_count",
            "outs",
            "metrics_summary.csv",
        )
        if os.path.exists(csv_path):
            df_metrics = pd.read_csv(csv_path, index_col=0).T
            row = {"Sample": sample, "Version": version}

            # Standard metrics
            for original_label, short_label in metrics_to_extract.items():
                if original_label in df_metrics.columns:
                    value = df_metrics.at[df_metrics.index[0], original_label]
                    row[short_label] = float(str(value).replace(",", ""))
                else:
                    print(f"⚠️  Missing metric '{original_label}' in file: {csv_path}")
                    row[short_label] = None

            # Fallback metrics
            for short_label, options in fallback_metrics.items():
                found = False
                for label in options:
                    if label in df_metrics.columns:
                        value = df_metrics.at[df_metrics.index[0], label]
                        row[short_label] = float(str(value).replace(",", ""))
                        found = True
                        break
                if not found:
                    print(f"⚠️  Missing fallback metrics {options} for '{short_label}' in file: {csv_path}")
                    row[short_label] = None

            data.append(row)
        else:
            print(f"❌ Missing file: {csv_path}")

# Build dataframe
df = pd.DataFrame(data)

# Export to CSV
df.to_csv("cellranger_comparison_metrics.csv", index=False)

# Bar plots for all metrics
df_melted = df.melt(id_vars=["Sample", "Version"], var_name="Metric", value_name="Value")
sns.set(style="whitegrid")
g = sns.catplot(
    data=df_melted,
    kind="bar",
    x="Sample",
    y="Value",
    hue="Version",
    col="Metric",
    col_wrap=2,
    sharey=False,
    height=4,
    aspect=1.5
)
g.set_titles("{col_name}")
g.fig.subplots_adjust(top=0.9)
g.fig.suptitle("Cell Ranger v7.2.0 vs v9.0.0 - Per Sample Bar Plots", fontsize=16)
plt.xticks(rotation=90)

#  Boxplot for Mean Reads per Cell
plt.figure(figsize=(6, 5))
sns.boxplot(data=df, x="Version", y="Mean_Reads_Per_Cell", palette="pastel")
plt.title("Distribution of Mean Reads per Cell by Version")
plt.ylabel("Mean Reads per Cell")
plt.xlabel("Cell Ranger Version")
plt.tight_layout()
plt.show()
